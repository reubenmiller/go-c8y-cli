{
  "information": {
    "name": "devices/services",
    "description": "Cumulocity device services",
    "descriptionLong": "Managed device services (introduced in 10.14)",
    "link": "https://cumulocity.com/guides/10.14.0/reference/device-management-library/#services"
  },
  "endpoints": [
    {
      "name": "listServices",
      "method": "GET",
      "description": "Get device services collection",
      "descriptionLong": "Get a collection of services of a device",
      "path": "inventory/managedObjects/{device}/childAdditions",
      "accept": "application/vnd.com.nsn.cumulocity.managedObjectReferenceCollection+json",
      "collectionType": "application/vnd.com.nsn.cumulocity.managedObject+json",
      "collectionProperty": "references.#.managedObject",
      "alias": {
        "go": "list",
        "powershell": "Get-DeviceServiceCollection"
      },
      "examples": {
        "powershell": [
          {
            "description": "Get a list of the child additions of an existing managed object",
            "command": "Get-DeviceServiceCollection -Id 12345",
            "skipTest": true
          },
          {
            "description": "Get a list of the child additions of an existing managed object (using pipeline)",
            "command": "Get-Device -Id 12345 | Get-DeviceServiceCollection",
            "skipTest": true
          }
        ],
        "go": [
          {
            "description": "Get a list of the child additions of an existing managed object",
            "command": "c8y devices services list --device 12345"
          },
          {
            "description": "Get a list of the child devices of an existing managed object",
            "command": "c8y devices services list --device 12345"
          }
        ]
      },
      "pathParameters": [
        {
          "name": "device",
          "type": "[]device",
          "pipeline": true,
          "pipelineAliases": [
            "deviceId",
            "source.id",
            "managedObject.id",
            "id"
          ],
          "required": true,
          "description": "Managed object id."
        }
      ],
      "queryParameters": [
        {
          "name": "query",
          "description": "Query expression group",
          "property": "query",
          "type": "queryExpression",
          "children": [
            {
              "name": "type",
              "type": "stringStatic",
              "description": "",
              "value": "(type eq 'c8y_Service')"
            },
            {
              "name": "query",
              "type": "string",
              "description": "Additional query filter",
              "format": "%s"
            },
            {
              "name": "serviceType",
              "type": "string",
              "description": "Filter by service type e.g. systemd",
              "format": "(serviceType eq '%s')"
            },
            {
              "name": "name",
              "type": "string",
              "description": "Filter by name",
              "format": "(name eq '%s')"
            },
            {
              "name": "status",
              "type": "string",
              "description": "Filter by service status",
              "validationSet": [
                "up",
                "down",
                "unknown"
              ],
              "format": "(status eq '%s')"
            },
            {
              "name": "orderBy",
              "type": "string",
              "description": "Order by. e.g. _id asc or name asc or creationTime.date desc"
            }
          ]
        }
      ]
    },
    {
      "name": "assignChild",
      "skip": true,
      "method": "POST",
      "path": "inventory/managedObjects/{id}/childAdditions",
      "accept": "application/vnd.com.nsn.cumulocity.managedObjectReference+json",
      "collectionType": "application/vnd.com.nsn.cumulocity.managedObject+json",
      "description": "Assign child",
      "descriptionLong": "Assign an existing managed object as a child to an existing managed object",
      "collectionProperty": "managedObject",
      "alias": {
        "go": "assign",
        "powershell": "Add-DeviceChild"
      },
      "examples": {
        "powershell": [
          {
            "description": "Add a related managed object as a child addition to an existing managed object",
            "command": "Add-DeviceChild -Id $software.id -Child $version.id -ChildType addition",
            "skipTest": true
          }
        ],
        "go": [
          {
            "description": "Add a related managed object as a child to an existing managed object",
            "command": "c8y inventory children assign --id 12345 --child 6789 --childType addition"
          }
        ]
      },
      "pathParameters": [
        {
          "name": "id",
          "type": "[]device",
          "property": "id",
          "required": true,
          "description": "Managed object id where the child will be assigned to",
          "position": 0
        },
        {
          "name": "childType",
          "type": "inventoryChildType",
          "description": "Child relationship type",
          "required": true,
          "validationSet": [
            "addition",
            "asset",
            "device"
          ]
        }
      ],
      "body": [
        {
          "name": "child",
          "type": "string",
          "position": 1,
          "pipeline": true,
          "pipelineAliases": [
            "deviceId",
            "source.id",
            "managedObject.id",
            "id"
          ],
          "required": true,
          "property": "managedObject.id",
          "description": "Managed object that will be assigned as a child"
        }
      ]
    },
    {
      "name": "unassignChild",
      "skip": true,
      "description": "Unassign child",
      "descriptionLong": "Unassign/delete an managed object as a child to an existing managed object",
      "method": "DELETE",
      "path": "inventory/managedObjects/{id}/{childType}/{child}",
      "accept": "",
      "alias": {
        "go": "unassign",
        "powershell": "Remove-DeviceChild"
      },
      "examples": {
        "powershell": [
          {
            "description": "Unassign a child addition from its parent managed object",
            "command": "Remove-DeviceChild -Id $software.id -Child $version.id -ChildType addition",
            "skipTest": true
          }
        ],
        "go": [
          {
            "description": "Unassign a child addition from a managed object",
            "command": "c8y inventory children unassign --id 12345 --child 22553 --childType addition"
          },
          {
            "description": "Unassign a child device from a managed object",
            "command": "c8y inventory children unassign --id 12345 --child 22553 --childType device"
          }
        ]
      },
      "pathParameters": [
        {
          "name": "id",
          "type": "[]device",
          "required": true,
          "description": "Managed object id"
        },
        {
          "name": "childType",
          "type": "inventoryChildType",
          "description": "Child relationship type",
          "required": true,
          "validationSet": [
            "addition",
            "asset",
            "device"
          ]
        },
        {
          "name": "child",
          "type": "string",
          "required": true,
          "pipeline": true,
          "pipelineAliases": [
            "deviceId",
            "source.id",
            "managedObject.id",
            "id"
          ],
          "description": "Child managed object id"
        }
      ]
    },
    {
      "name": "createService",
      "method": "POST",
      "path": "inventory/managedObjects/{id}/childAdditions",
      "accept": "application/json",
      "contentType": "application/vnd.com.nsn.cumulocity.managedObject+json",
      "collectionType": "application/vnd.com.nsn.cumulocity.managedObject+json",
      "description": "Create child",
      "descriptionLong": "Create a new managed object and assign it to an existing managed object as a child",
      "alias": {
        "go": "create",
        "powershell": "New-DeviceService"
      },
      "examples": {
        "powershell": [
          {
            "description": "Create a child addition and link it to an existing managed object",
            "command": "New-DeviceService -Id $software.id -Data \"custom.value=test\" -Global -ChildType addition",
            "skipTest": true
          }
        ],
        "go": [
          {
            "description": "Create a child addition and link it to an existing managed object",
            "command": "c8y devices services create --device 12345 --name ntp --status up",
            "assertStdOut": {
              "json": {
                "path": "r//inventory/managedObjects/\\d+/childAdditions$",
                "body.custom.value": "test",
                "body.c8y_Global": "{}"
              }
            }
          }
        ]
      },
      "pathParameters": [
        {
          "name": "device",
          "type": "[]device",
          "property": "id",
          "required": true,
          "pipeline": true,
          "pipelineAliases": [
            "deviceId",
            "source.id",
            "managedObject.id",
            "id"
          ],
          "description": "Managed object id where the child addition will be added to",
          "position": 0
        }
      ],
      "body": [
        {
          "name": "name",
          "type": "string",
          "description": "Service name"
        },
        {
          "name": "serviceType",
          "type": "string",
          "description": "Service type, e.g. systemd"
        },
        {
          "name": "status",
          "type": "string",
          "description": "Service status",
          "validationSet": [
            "up",
            "down",
            "unknown"
          ]
        },
        {
          "name": "type",
          "type": "stringStatic",
          "description": "type",
          "value": "c8y_Service"
        },
        {
          "name": "data",
          "type": "json",
          "description": "Additional properties of the inventory."
        }
      ],
      "bodyRequiredKeys": [
        "name",
        "status",
        "type",
        "serviceType"
      ]
    },
    {
      "name": "update",
      "method": "PUT",
      "path": "inventory/managedObjects/{id}",
      "accept": "application/json",
      "contentType": "application/vnd.com.nsn.cumulocity.managedObject+json",
      "collectionType": "application/vnd.com.nsn.cumulocity.managedObject+json",
      "description": "Update service status",
      "descriptionLong": "Update service status",
      "alias": {
        "go": "update",
        "powershell": "Update-DeviceService"
      },
      "examples": {
        "powershell": [
          {
            "description": "Update service status",
            "command": "Update-DeviceService -Id 12345 -Status up",
            "skipTest": true
          }
        ],
        "go": [
          {
            "description": "Update service status",
            "command": "c8y devices services update --id 12345 --status up"
          },
          {
            "description": "Update service status",
            "command": "c8y devices services --device 12345 --name ntp | c8y devices services update --status up",
            "skipTest": true
          }
        ]
      },
      "pathParameters": [
        {
          "name": "id",
          "type": "[]id",
          "property": "id",
          "required": true,
          "pipeline": true,
          "pipelineAliases": [
            "managedObject.id",
            "id"
          ],
          "description": "Service id",
          "position": 0
        }
      ],
      "body": [
        {
          "name": "name",
          "type": "string",
          "description": "Service name"
        },
        {
          "name": "serviceType",
          "type": "string",
          "description": "Service type, e.g. systemd"
        },
        {
          "name": "status",
          "type": "string",
          "description": "Service status",
          "validationSet": [
            "up",
            "down",
            "unknown"
          ]
        },
        {
          "name": "data",
          "type": "json",
          "description": "Additional properties."
        }
      ]
    },
    {
      "name": "getChild",
      "skip": true,
      "description": "Get child",
      "descriptionLong": "Get managed object child",
      "method": "GET",
      "path": "inventory/managedObjects/{id}/childAdditions/{child}",
      "accept": "application/vnd.com.nsn.cumulocity.managedObjectReference+json",
      "collectionProperty": "managedObject",
      "alias": {
        "go": "get",
        "powershell": "Get-DeviceChild"
      },
      "examples": {
        "powershell": [
          {
            "description": "Get an existing child managed object",
            "command": "Get-DeviceChild -Id $Agent.id -Child $Ref.id -ChildType addition",
            "skipTest": true
          }
        ],
        "go": [
          {
            "description": "Get an existing child addition reference",
            "command": "c8y inventory children get --id 12345 --child 12345 --childType addition"
          }
        ]
      },
      "pathParameters": [
        {
          "name": "id",
          "type": "[]device",
          "pipeline": true,
          "pipelineAliases": [
            "deviceId",
            "source.id",
            "managedObject.id",
            "id"
          ],
          "required": true,
          "description": "Managed object id"
        },
        {
          "name": "childType",
          "type": "inventoryChildType",
          "description": "Child relationship type",
          "required": true,
          "validationSet": [
            "addition",
            "asset",
            "device"
          ]
        },
        {
          "name": "child",
          "type": "[]device",
          "required": true,
          "description": "Child managed object id"
        }
      ]
    }
  ]
}
